<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Boson::Pipe [RDoc Documentation]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Module</span>
          Boson::Pipe
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/boson/pipe_rb.html">lib/boson/pipe.rb</a>
          </li>
        </ol>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            This module passes an original command&#8217;s return value through
            methods/commands specified as pipe options. <a href="Pipe.html">Pipe</a>
            options are processed in this order:
            </p>
            <ul>
            <li>A :query option searches an array of objects or hashes using
            Pipes.search_pipe.
            
            </li>
            <li>A :sort option sorts an array of objects or hashes using <a
            href="Pipes.html#M000052">Pipes.sort_pipe</a>.
            
            </li>
            <li>A :pipes option takes an array of commands that modify the return value
            using <a href="Pipes.html#M000054">Pipes.pipes_pipe</a>.
            
            </li>
            <li>All user-defined pipe options (:pipe_options key in <a
            href="Repo.html#M000094">Repo.config</a>) are processed in random order.
            
            </li>
            </ul>
            <p>
            Some points:
            </p>
            <ul>
            <li>User-defined pipes call a command (the option&#8217;s name by default).
            It&#8217;s the user&#8217;s responsibility to have this command loaded when
            used. The easiest way to do this is by adding the pipe command&#8217;s
            library to :defaults in main config.
            
            </li>
            <li>By default, pipe commands do not modify the value their given. This means
            you can activate multiple pipes using a method&#8217;s original return
            value.
            
            </li>
            <li>A pipe command expects a command&#8217;s return value as its first
            argument. If the pipe option takes an argument, it&#8217;s passed on as a
            second argument.
            
            </li>
            <li>When piping occurs in relation to rendering depends on the Hirb view. With
            the default Hirb view, piping occurs occurs in the middle of the rendering,
            after Hirb has converted the return value into an array of hashes. If using
            a custom Hirb view, piping occurs before rendering.
            
            </li>
            <li>What the pipe command should expect as a return value depends on the type
            of command. If it&#8217;s a command rendered with hirb&#8217;s tables, the
            return value is a an array of hashes. For everything else, it&#8217;s the
            method&#8217;s original return value.
            
            </li>
            </ul>
            <h3>User <a href="Pipes.html">Pipes</a></h3>
            <p>
            User pipes have the following attributes which alter their behavior:
            </p>
            <dl>
            <dt><b>:pipe</b></dt><dd><a href="Pipe.html">Pipe</a> command the pipe executes when called. Default
            is the pipe&#8217;s name.
            
            </dd>
            <dt><b>:env</b></dt><dd>Boolean which enables passing an additional hash to the pipe command. This
            hash contains information from the first command&#8217;s input with the
            following keys: :args (command&#8217;s arguments), :options
            (command&#8217;s options), :global_options (command&#8217;s global options)
            and :config (a command&#8217;s configuration hash). Default is false.
            
            </dd>
            <dt><b>:filter</b></dt><dd>Boolean which has the pipe command modify the original command&#8217;s
            output with the value it returns. Default is false.
            
            </dd>
            <dt><b>:no_render</b></dt><dd>Boolean to turn off auto-rendering of the original command&#8217;s final
            output. Only applicable to :filter enabled pipes. Default is false.
            
            </dd>
            <dt><b>:solo</b></dt><dd>Boolean to indicate this pipe can&#8217;t run with other user pipes or
            pipes from :pipes option. If a user calls multiple solo pipes, only the
            first one detected is called.
            
            </dd>
            </dl>
            <h3>User <a href="Pipes.html">Pipes</a> Example</h3>
            <p>
            Let&#8217;s say you want to have two commands, browser and copy, you want
            to make available as pipe options:
            </p>
            <pre># Opens url in browser. This command already ships with Boson.&#x000A;def browser(url)&#x000A;  system('open', url)&#x000A;end&#x000A;&#x000A;# Copy to clipboard&#x000A;def copy(str)&#x000A;  IO.popen('pbcopy', 'w+') {|clipboard| clipboard.write(str)}&#x000A;end</pre>
            <p>
            To configure them, drop the following config in ~/.boson/config/boson.yml:
            </p>
            <pre>:pipe_options:&#x000A;  :browser:&#x000A;    :type: :boolean&#x000A;    :desc: Open in browser&#x000A;  :copy:&#x000A;    :type: :boolean&#x000A;    :desc: Copy to clipboard</pre>
            <p>
            Now for any command that returns a url string, these pipe options can be
            turned on to execute the url.
            </p>
            <p>
            Some examples of these options using commands from <a
            href="http://github.com/cldwalker/irbfiles">my libraries</a>:
            </p>
            <pre># Creates a gist and then opens url in browser and copies it.&#x000A;$ cat some_file | boson gist -bC        # or cat some_file | boson gist --browser --copy&#x000A;&#x000A;# Generates rdoc in current directory and then opens it in browser&#x000A;irb&gt;&gt; rdoc '-b'    # or rdoc '--browser'</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000045">add_pipes</a></li>
              <li><a href="#M000044">process_pipes</a></li>
              <li><a href="#M000043">scientist_process</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Module <a href="Pipe/TableCallbacks.html" class="link">Boson::Pipe::TableCallbacks</a><br />
            </div>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000045'>
                <a name='M000045'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_pipes</span>
                  <span class='arguments'>(hash)</span>
                </div>
                <div class='description'>
                  <p>
                  A hash that defines user pipes in the same way as the :pipe_options key in
                  <a href="Repo.html#M000094">Repo.config</a>. This method should be called
                  when a pipe&#8217;s library is loading.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000045-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000045-source'><span class="ruby-comment cmt"># File lib/boson/pipe.rb, line 83</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_pipes</span>(<span class="ruby-identifier">hash</span>)&#x000A;      <span class="ruby-identifier">pipe_options</span>.<span class="ruby-identifier">merge!</span> <span class="ruby-identifier">setup_pipes</span>(<span class="ruby-identifier">hash</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000044'>
                <a name='M000044'>      </a>
                <div class='synopsis'>
                  <span class='name'>process_pipes</span>
                  <span class='arguments'>(obj, options)</span>
                </div>
                <div class='description'>
                  <p>
                  Main method which processes all pipe commands, both default and
                  user-defined ones.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000044-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000044-source'><span class="ruby-comment cmt"># File lib/boson/pipe.rb, line 74</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_pipes</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">options</span>)&#x000A;      <span class="ruby-identifier">internal_pipes</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">pipe</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">obj</span> = <span class="ruby-constant">Pipes</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{pipe}_pipe&quot;</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">pipe</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">pipe</span>]&#x000A;      }&#x000A;      <span class="ruby-identifier">process_user_pipes</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">options</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000043'>
                <a name='M000043'>      </a>
                <div class='synopsis'>
                  <span class='name'>scientist_process</span>
                  <span class='arguments'>(object, global_opt, env={})</span>
                </div>
                <div class='description'>
                  <p>
                  Process pipes from scientist
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000043-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000043-source'><span class="ruby-comment cmt"># File lib/boson/pipe.rb, line 67</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scientist_process</span>(<span class="ruby-identifier">object</span>, <span class="ruby-identifier">global_opt</span>, <span class="ruby-identifier">env</span>={})&#x000A;      <span class="ruby-ivar">@env</span> = <span class="ruby-identifier">env</span>&#x000A;      [<span class="ruby-identifier">:query</span>, <span class="ruby-identifier">:sort</span>, <span class="ruby-identifier">:reverse_sort</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">global_opt</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">e</span>) } <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)&#x000A;      <span class="ruby-identifier">process_pipes</span>(<span class="ruby-identifier">object</span>, <span class="ruby-identifier">global_opt</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
